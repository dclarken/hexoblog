---
title: Nginx和Apache负载均衡比较
date: 2017-10-13 00:08:12
tags: [笔记,Linux,apache,nginx]
categories: [笔记,Linux,]
comments: false
---
![mahua](https://ooo.0o0.ooo/2017/10/30/59f6fa7fc3b66.png)
<!--more-->
## Apache与Nginx的优缺点比较 （同步阻塞与异步非阻塞的比较）

nginx相对于apache的优点：
 
* 轻量级，同样起web 服务，比apache 占用更少的内存及资源 
* 抗并发，nginx 处理请求是异步非阻塞的，而apache 则是同步阻塞型的，在高并发下nginx 能保持低资源低消耗高性能 ，适合静态请求和做反向代理服务器
* 高度模块化的设计，编写模块相对简单 
* 社区活跃，各种高性能模块出品迅速 

apache 相对于nginx 的优点： 

* rewrite ，比nginx 的rewrite 强大，处理动态请求比较好 
* 模块超多，基本想到的都可以找到 
* 少bug ，nginx 的bug 相对较多 
* 稳定 

两者最核心的区别在于 apache 是同步多进程模型，同步阻塞模型，一个连接对应一个进程，对于动态请求支持比较好，而 nginx 是异步非阻塞模型，多个连接（万级别）可以对应一个进程，对于静态和反向请求支持比较好。

---

## 同步与异步

同步与异步同步和异步关注的是消息通信机制 (synchronous communication/ asynchronous communication)所谓同步，就是在发出一个**调用**时，在没有得到结果之前，该**调用**就不返回。但是一旦调用返回，就得到返回值了。换句话说，就是由**调用者**主动等待这个**调用**的结果。而异步则是相反，**调用**在发出之后，这个调用就直接返回了，所以没有返回结果。换句话说，当一个异步过程调用发出后，调用者不会立刻得到结果。而是在**调用**发出后，**被调用者**通过状态、通知来通知调用者，或通过回调函数处理这个调用。典型的异步编程模型比如Node.js

举个通俗的例子：你打电话问书店老板有没有《分布式系统》这本书，如果是同步通信机制，书店老板会说，你稍等，”我查一下"，然后开始查啊查，等查好了（可能是5秒，也可能是一天）告诉你结果（返回结果）。而异步通信机制，书店老板直接告诉你我查一下啊，查好了打电话给你，然后直接挂电话了（不返回结果）。然后查好了，他会主动打电话给你。在这里老板通过“回电”这种方式来回调。

## 阻塞与非阻塞

阻塞与非阻塞阻塞和非阻塞关注的是程序在等待调用结果（消息，返回值）时的状态，阻塞调用是指调用结果返回之前，当前线程会被挂起，调用线程只有在得到结果之后才会返回。非阻塞调用指在不能立刻得到结果之前，该调用不会阻塞当前线程。

还是上面的例子，你打电话问书店老板有没有《分布式系统》这本书，你如果是阻塞式调用，你会一直把自己“挂起”，直到得到这本书有没有的结果，如果是非阻塞式调用，你不管老板有没有告诉你，你自己先一边去玩了， 当然你也要偶尔过几分钟check一下老板有没有返回结果。在这里阻塞与非阻塞与是否同步异步无关。跟老板通过什么方式回答你结果无关